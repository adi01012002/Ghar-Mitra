import{a}from"./index-BusJa6OU.js";const s="https://ghar-mitra-backend.onrender.com",d=async r=>{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const t={headers:{Authorization:`Bearer ${e}`}};try{const o=await a.post(`${s}/students/add`,r,t);return alert("Student successfully added!"),o.data}catch(o){throw o.response?o.response.data:new Error("Network error")}},E=async()=>{const r=localStorage.getItem("token");if(!r)throw new Error("No token found");const e={headers:{Authorization:`Bearer ${r}`}};try{const t=await a.get(`${s}/students/list`,e);if(console.log(t),console.log(t.data),t&&t.data)return t.data;throw new Error("API response does not contain 'students'")}catch(t){throw console.error("Error fetching students:",t),t}},S=async r=>{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const t={headers:{Authorization:`Bearer ${e}`}},o=await a.get(`${s}/students/${r}`,t);return console.log(o),console.log("Fetched student from API:",o.data),o.data},l=async r=>{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const t={headers:{Authorization:`Bearer ${e}`}},o=await a.delete(`${s}/students/${r}`,t);return alert("Student deleted successfully!"),o.data},y=async(r,e)=>{console.log(r,e);const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const o={headers:{Authorization:`Bearer ${t}`}},{data:n}=await a.put(`${s}/students/edit/${r}`,e,o);return console.log(n),n},u=async r=>{var e,t;try{return(await a.get(`${s}/students/${r}/profile`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data}catch(o){throw new Error(((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch profile")}},T=async r=>{try{const e=await a.get(`${s}/students/${r}/payments`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});return console.log(e.data),e.data}catch(e){throw new Error(e.response?e.response.data.message:e.message)}},p=r=>async e=>{var t,o;e({type:"ADD_STUDENT_REQUEST"});try{const{student:n}=await d(r);e({type:"ADD_STUDENT_SUCCESS",payload:n})}catch(n){console.error("Error adding student:",n),e({type:"ADD_STUDENT_FAILURE",payload:((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||n.message})}},_=()=>async r=>{var e,t;r({type:"FETCH_STUDENTS_REQUEST"});try{const o=await E();r({type:"FETCH_STUDENTS_SUCCESS",payload:o})}catch(o){console.error("Error fetching students:",o),r({type:"FETCH_STUDENTS_FAIL",payload:((t=(e=o.response)==null?void 0:e.data)==null?void 0:t.message)||o.message})}},i=r=>async e=>{var t,o;e({type:"FETCH_STUDENT_BY_ID_REQUEST"});try{const n=await S(r);e({type:"FETCH_STUDENT_BY_ID_SUCCESS",payload:n})}catch(n){console.error(`Error fetching student with ID ${r}:`,n),e({type:"FETCH_STUDENT_BY_ID_FAILURE",payload:((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||n.message})}},U=r=>async e=>{var t,o;e({type:"DELETE_STUDENT_REQUEST"});try{await l(r),e({type:"DELETE_STUDENT_SUCCESS",payload:r})}catch(n){console.error(`Error deleting student with ID ${r}:`,n),e({type:"DELETE_STUDENT_FAILURE",payload:((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||n.message})}},h=(r,e)=>async t=>{var o,n;console.log(r,e),console.log("dkdkdkkdkdkdkkkdkkddkdkdkdk"),t({type:"UPDATE_STUDENT_REQUEST"});try{const c=await y(r,e);t({type:"UPDATE_STUDENT_SUCCESS",payload:c})}catch(c){console.error(`Error updating student with ID ${r}:`,c),t({type:"UPDATE_STUDENT_FAILURE",payload:((n=(o=c.response)==null?void 0:o.data)==null?void 0:n.message)||c.message})}},w=r=>async e=>{var t;e({type:"FETCH_PROFILE_REQUEST"});try{const o=await u(r);e({type:"FETCH_PROFILE_SUCCESS",payload:o})}catch(o){e({type:"FETCH_PROFILE_FAILURE",payload:((t=o.response)==null?void 0:t.data.message)||o.message})}},f=r=>async e=>{e({type:"FETCH_PAYMENTS_REQUEST"});try{const t=await T(r);e({type:"FETCH_PAYMENTS_SUCCESS",payload:t})}catch(t){e({type:"FETCH_PAYMENTS_FAILURE",payload:t.message})}};export{p as a,_ as b,w as c,U as d,f as e,i as f,h as u};
